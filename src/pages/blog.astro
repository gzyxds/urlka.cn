---
import Pagination from '../components/Pagination.astro';
import Breadcrumb from '../components/layout/Breadcrumb.astro';
import Layout from '../layouts/Layout.astro';
import { getCollection } from "astro:content";

// Filter blog entries with 'draft: false' & date before current date
const publishedBlogEntries = await getCollection("blog", ({ data }) => {
  return !data.draft && data.publishDate < new Date();
});

// Sort content entries by publication date
publishedBlogEntries.sort(function (a, b) {
  return b.data.publishDate.valueOf() - a.data.publishDate.valueOf();
});

// 博客图片列表
const blogImages = [
  'blog-01.jpg',
  'blog-02.jpg', 
  'blog-03.jpg',
  'blog-1.jpg',
  'blog-2.jpg',
  'blog-3.jpg',
  'blog-4.jpg',
  'blog-5.jpg',
  'blog-details-01.jpg'
];

// 为每篇文章分配随机图片
const getRandomImage = (index: number) => {
  const imageIndex = index % blogImages.length;
  return `/assets/blog/${blogImages[imageIndex]}`;
};
---

<Layout
  description="172号卡官网！我们提供最新的电信、移动、联通和广电流量卡及物联卡的在线申请和办理服务,加入我们的分销管理平台,成为代理合伙人,轻松管理您的流量卡业务,获取丰厚收益"
  title="172号卡官网_172号卡分销系统_172号卡管理平台_172号卡代理商_172号卡平台网站_流量卡管理平台"
  keywords="172号卡平台,172号卡官网,172号卡分销系统,172号卡订单管理系统,172号卡分销系统官网,172号卡平台官网,172号卡网"
>
  <Breadcrumb>
    <Fragment slot="title">172号卡资讯</Fragment>
  </Breadcrumb>
  <section class="bg-white dark:bg-dark py-12 lg:py-20">
    <div class="container mx-auto px-4">
      <!-- 标题区域 -->
      <div class="mb-10 lg:mb-14 max-w-[520px] mx-auto text-center">
        <span class="block mb-2 text-lg font-semibold text-primary">新闻资讯</span>
        <h2 class="text-dark dark:text-white mb-3 text-2xl sm:text-3xl md:text-4xl font-bold">172号卡资讯</h2>
        <p class="text-sm sm:text-base text-body-color dark:text-dark-6">了解最新行业动态和产品资讯</p>
      </div>

      <!-- 博客卡片网格 -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5 lg:gap-6">
        {
          publishedBlogEntries.map((blogPostEntry, index) => (
            <a href={`/blog/${blogPostEntry.slug}`} class="group bg-white dark:bg-dark-2 rounded-lg border border-gray-200 dark:border-dark-3 overflow-hidden">
              <!-- 图片区域 -->
              <div class="h-48 sm:h-52 overflow-hidden">
                <img
                  src={getRandomImage(index)}
                  alt={blogPostEntry.data.title}
                  class="w-full h-full object-cover"
                />
              </div>
              <!-- 内容区域 -->
              <div class="p-4 sm:p-5">
                <span class="inline-block px-3 py-1 mb-3 text-xs font-medium text-primary bg-primary/10 rounded">
                  {blogPostEntry.data.publishDate.toLocaleDateString('zh-CN')}
                </span>
                <h3 class="text-base sm:text-lg font-semibold text-dark dark:text-white mb-2 line-clamp-2 group-hover:text-primary transition-colors">
                  {blogPostEntry.data.title}
                </h3>
                <p class="text-sm text-body-color dark:text-dark-6 line-clamp-2">
                  {blogPostEntry.data.snippet || "阅读更多精彩内容..."}
                </p>
              </div>
            </a>
          ))
        }
      </div>

      <Pagination />
    </div>
  </section>
</Layout>
